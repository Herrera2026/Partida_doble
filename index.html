<!DOCTYPE html>
<!--
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘  LibroDiario SV â€” Sistema Contable Interactivo                         â•‘
  â•‘  Autor  : Miguel Antonio Herrera ChÃ¡vez                                â•‘
  â•‘  Clase  : Contabilidad I Â· Universidad Gerardo Barrios                 â•‘
  â•‘  VersiÃ³n: 2.0                                                           â•‘
  â•‘                                                                          â•‘
  â•‘  DESCRIPCIÃ“N GENERAL                                                    â•‘
  â•‘  AplicaciÃ³n web de una sola pÃ¡gina (SPA) que automatiza el ciclo       â•‘
  â•‘  contable bÃ¡sico de El Salvador:                                        â•‘
  â•‘    1. Recibe montos de 10 operaciones (apertura + 9 transacciones)      â•‘
  â•‘    2. Genera partidas del Libro Diario con IVA 13%                      â•‘
  â•‘    3. Traslada saldos al Libro Mayor (Cuentas T)                        â•‘
  â•‘    4. Calcula la LiquidaciÃ³n de IVA del perÃ­odo                         â•‘
  â•‘                                                                          â•‘
  â•‘  CONCEPTOS CONTABLES CLAVE                                              â•‘
  â•‘  Â· CrÃ©dito Fiscal (CF): IVA pagado en compras/gastos â†’ Activo 1104     â•‘
  â•‘  Â· DÃ©bito Fiscal (DF): IVA cobrado en ventas â†’ Pasivo 2102             â•‘
  â•‘  Â· LiquidaciÃ³n: DF - CF = IVA a enterar (o remanente a favor)          â•‘
  â•‘                                                                          â•‘
  â•‘  TECNOLOGÃAS                                                             â•‘
  â•‘    Â· HTML5 semÃ¡ntico                                                    â•‘
  â•‘    Â· CSS3 con variables personalizadas (custom properties)             â•‘
  â•‘    Â· JavaScript ES6+ (sin frameworks, sin dependencias externas)       â•‘
  â•‘    Â· Google Fonts: Libre Baskerville Â· IBM Plex Mono Â· DM Sans         â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LibroDiario SV â€” Sistema Contable</title>

  <!--
    FUENTES TIPOGRÃFICAS (Google Fonts CDN)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    Â· Libre Baskerville  â†’ TÃ­tulos y encabezados (serif clÃ¡sico)
    Â· IBM Plex Mono      â†’ NÃºmeros, cÃ³digos y montos (monoespaciada)
    Â· DM Sans            â†’ Texto general de la interfaz (sans-serif moderna)
  -->
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=IBM+Plex+Mono:wght@400;600&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VARIABLES CSS (DESIGN TOKENS)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Se definen en :root para reutilizaciÃ³n en todo el documento.
   Nomenclatura:
   Â· --ink*    â†’ Capas de fondo oscuro (de mÃ¡s oscuro a mÃ¡s claro)
   Â· --ledger* â†’ Color verde contable principal y sus variantes
   Â· --gold*   â†’ Dorado para acentos y resaltados
   Â· --debit*  â†’ Rojo para valores en el Debe
   Â· --credit* â†’ Verde para valores en el Haber
   Â· --text*   â†’ Colores de texto (principal y secundario)
   Â· --border  â†’ Color de bordes y separadores
   Â· --shadow  â†’ Sombra estÃ¡ndar de tarjetas
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --ink:          #0f1923;  /* Fondo base de la pÃ¡gina */
  --ink2:         #1c2d3a;  /* Fondo de tarjetas principales */
  --ink3:         #243447;  /* Fondo de elementos secundarios */
  --ledger:       #0d6e4f;  /* Verde contable â€” color primario */
  --ledger-light: #14a077;  /* Verde mÃ¡s claro para hover y foco */
  --ledger-dim:   rgba(13,110,79,0.15);  /* Verde semitransparente para fondos */
  --gold:         #c9a84c;  /* Dorado para partidas y acentos */
  --gold-dim:     rgba(201,168,76,0.12); /* Dorado semitransparente */
  --debit:        #e05252;  /* Rojo para columna Debe */
  --debit-dim:    rgba(224,82,82,0.12);  /* Rojo semitransparente */
  --credit:       #3cb47a;  /* Verde para columna Haber */
  --credit-dim:   rgba(60,180,122,0.12); /* Verde semitransparente */
  --text:         #f0ede6;  /* Texto principal (casi blanco cÃ¡lido) */
  --text2:        #8fa3b8;  /* Texto secundario (gris azulado) */
  --border:       rgba(255,255,255,0.07); /* Bordes sutiles */
  --shadow:       0 8px 32px rgba(0,0,0,0.45); /* Sombra estÃ¡ndar */
}

/* â”€â”€ RESET GLOBAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Elimina mÃ¡rgenes y rellenos predeterminados del navegador.
   box-sizing: border-box incluye bordes y padding en el ancho total.
   scroll-behavior: smooth activa animaciones de desplazamiento.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*,*::before,*::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }

/* â”€â”€ BODY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Fondo oscuro con gradientes radiales decorativos en las esquinas:
   Â· Esquina superior izquierda: tono verde sutil
   Â· Esquina inferior derecha: tono dorado sutil
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
body {
  background: var(--ink);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 14px;
  line-height: 1.6;
  background-image:
    radial-gradient(ellipse at 15% 0%,   rgba(13,110,79,0.13) 0%, transparent 55%),
    radial-gradient(ellipse at 85% 100%, rgba(201,168,76,0.08) 0%, transparent 55%);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: ENCABEZADO (HEADER)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Barra de navegaciÃ³n fija en la parte superior (sticky).
   Contiene: logotipo + nombre de la app + etiquetas informativas.
   z-index: 200 para que quede sobre el contenido al hacer scroll.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hdr {
  background: var(--ink2);
  border-bottom: 1px solid var(--border);
  padding: 0 28px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 200;
  box-shadow: 0 2px 24px rgba(0,0,0,0.5);
}

/* Contenedor del logotipo: Ã­cono + nombre + subtÃ­tulo */
.logo        { display: flex; align-items: center; gap: 11px; }
.logo-icon   { width: 34px; height: 34px; background: var(--ledger); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem; }
.logo-name   { font-family: 'Libre Baskerville', serif; font-size: 1.1rem; }
.logo-sub    { font-size: 0.65rem; color: var(--text2); letter-spacing: 2px; text-transform: uppercase; display: block; }

/* Badges del encabezado: etiquetas de informaciÃ³n contextual */
.hdr-badges  { display: flex; gap: 8px; }
.pill        { border-radius: 20px; padding: 3px 11px; font-size: 0.7rem; font-weight: 700; letter-spacing: .5px; }
.pill-g      { background: var(--ledger-dim); color: var(--credit); border: 1px solid rgba(60,180,122,0.2); }   /* Verde: IVA 13% */
.pill-a      { background: var(--gold-dim);   color: var(--gold);   border: 1px solid rgba(201,168,76,0.22); } /* Dorado: info adicional */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT PRINCIPAL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   .wrap: contenedor centrado con ancho mÃ¡ximo de 1140px.
   Padding inferior generoso para no cortar contenido al final.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.wrap { max-width: 1140px; margin: 0 auto; padding: 28px 18px 80px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: TARJETA (CARD)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Contenedor visual de secciones. Usa fondo --ink2 sobre --ink.
   .card-head: fila superior con tÃ­tulo y acciones de la tarjeta.
   .card-lbl: subtÃ­tulo monoespaciado en verde (etiqueta de secciÃ³n).
   .card-ttl: tÃ­tulo principal en serif.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card      { background: var(--ink2); border: 1px solid var(--border); border-radius: 12px; padding: 26px; margin-bottom: 22px; box-shadow: var(--shadow); }
.card-head { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border); gap: 12px; flex-wrap: wrap; }
.card-lbl  { font-family: 'IBM Plex Mono', monospace; font-size: 0.65rem; letter-spacing: 3px; text-transform: uppercase; color: var(--ledger-light); margin-bottom: 4px; }
.card-ttl  { font-family: 'Libre Baskerville', serif; font-size: 1.3rem; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: PANEL DE ENTRADA DE DATOS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   .ops-grid   : cuadrÃ­cula responsiva de tarjetas de operaciÃ³n.
                 auto-fill: llena el espacio disponible.
                 minmax(220px, 1fr): mÃ­nimo 220px, mÃ¡ximo fracciÃ³n libre.
   .op-block   : tarjeta individual de cada operaciÃ³n (fondo --ink3).
   .op-head    : fila con nÃºmero de operaciÃ³n + tÃ­tulo.
   .op-num     : insignia circular con el nÃºmero de operaciÃ³n.
   .iw         : wrapper del input con posiciÃ³n relativa (para el prefijo $).
   .ipfx       : sÃ­mbolo "$" posicionado absolutamente dentro del input.
   .field      : campo de texto numÃ©rico estilizado.
   .op-meta    : fila inferior con descripciÃ³n + toggle de IVA.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ops-grid  { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px,1fr)); gap: 12px; }
.op-block  { background: var(--ink3); border: 1.5px solid rgba(255,255,255,0.07); border-radius: 9px; padding: 14px; transition: border-color .2s; }
.op-block:hover { border-color: rgba(13,110,79,.35); } /* Resaltado verde al pasar el cursor */
.op-head   { display: flex; align-items: center; gap: 9px; margin-bottom: 10px; }
.op-num    { width: 24px; height: 24px; border-radius: 6px; background: var(--ledger-dim); color: var(--ledger-light); display: flex; align-items: center; justify-content: center; font-family: 'IBM Plex Mono', monospace; font-size: .7rem; font-weight: 700; flex-shrink: 0; }
.op-ttl    { font-size: .82rem; font-weight: 600; color: var(--text); line-height: 1.3; }
.iw        { position: relative; }
.ipfx      { position: absolute; left: 11px; top: 50%; transform: translateY(-50%); color: var(--ledger-light); font-family: 'IBM Plex Mono', monospace; font-weight: 700; font-size: .85rem; pointer-events: none; }
.field     { width: 100%; padding: 10px 10px 10px 28px; background: var(--ink); border: 1.5px solid rgba(255,255,255,.08); border-radius: 7px; color: var(--text); font-family: 'IBM Plex Mono', monospace; font-size: .92rem; transition: border-color .2s, background .2s; }
.field:focus { outline: none; border-color: var(--ledger-light); background: var(--ink2); }
.op-meta   { margin-top: 8px; display: flex; align-items: center; justify-content: space-between; }
.iva-lbl   { font-size: .68rem; color: var(--text2); }

/* â”€â”€ TOGGLE SWITCH DE IVA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Control personalizado que reemplaza un checkbox estÃ¡ndar.
   .tw    : contenedor clickeable (activa toggleSw() via onclick).
   .sw    : pista del toggle (fondo gris = apagado, verde = encendido).
   .sw.on : estado activo â€” fondo verde + posiciÃ³n del knob a la derecha.
   .sw-k  : botÃ³n deslizante circular del toggle.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.tw    { display: flex; align-items: center; gap: 6px; cursor: pointer; user-select: none; }
.sw    { width: 32px; height: 17px; background: rgba(255,255,255,.1); border-radius: 9px; position: relative; transition: background .2s; flex-shrink: 0; }
.sw.on { background: var(--ledger); }             /* Estado: IVA activado */
.sw-k  { position: absolute; width: 11px; height: 11px; background: #fff; border-radius: 50%; top: 3px; left: 3px; transition: left .2s; }
.sw.on .sw-k { left: 18px; }                      /* Knob desplazado a la derecha */

/* â”€â”€ FILA DE APERTURA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Tratamiento especial para la operaciÃ³n de apertura:
   borde dorado para distinguirla como punto de inicio del ciclo.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.apert-row { background: var(--ink3); border: 1.5px solid rgba(201,168,76,.18); border-radius: 9px; padding: 16px; margin-bottom: 14px; display: flex; align-items: center; gap: 16px; flex-wrap: wrap; }
.apert-lbl { font-weight: 700; color: var(--gold); font-size: .88rem; flex: 1; min-width: 160px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: BOTÃ“N CALCULAR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BotÃ³n principal de acciÃ³n. Ocupa el 100% del ancho disponible.
   Efectos: sombra verde al hover, escala reducida al clic (active).
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.calc-btn        { width: 100%; margin-top: 16px; background: var(--ledger); color: #fff; border: none; border-radius: 9px; padding: 15px 24px; font-family: 'DM Sans', sans-serif; font-size: 1rem; font-weight: 700; cursor: pointer; letter-spacing: .3px; box-shadow: 0 4px 18px rgba(13,110,79,.4); transition: background .2s, transform .1s, box-shadow .2s; display: flex; align-items: center; justify-content: center; gap: 10px; }
.calc-btn:hover  { background: var(--ledger-light); box-shadow: 0 6px 26px rgba(13,110,79,.55); }
.calc-btn:active { transform: scale(.98); } /* Feedback visual al presionar */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: PESTAÃ‘AS (TABS)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Sistema de navegaciÃ³n por pestaÃ±as para los resultados:
   Â· Libro Diario  â†’ Lista de partidas contables
   Â· Cuentas T     â†’ Libro Mayor con saldos
   Â· CatÃ¡logo      â†’ Plan de cuentas
   .tab.on : pestaÃ±a activa con fondo elevado y sombra.
   .panel  : contenido de cada pestaÃ±a (oculto por defecto).
   .panel.on: panel visible (activado por showTab()).
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tabs         { display: flex; gap: 3px; background: var(--ink); border-radius: 10px; padding: 4px; border: 1px solid var(--border); margin-bottom: 22px; }
.tab          { flex: 1; background: transparent; border: none; color: var(--text2); padding: 10px 12px; border-radius: 7px; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: .85rem; font-weight: 500; transition: all .2s; }
.tab:hover    { color: var(--text); background: rgba(255,255,255,.04); }
.tab.on       { background: var(--ink2); color: var(--text); box-shadow: 0 2px 10px rgba(0,0,0,.3); }
.panel        { display: none; }
.panel.on     { display: block; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: PARTIDA DE DIARIO (.je = journal entry)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Estructura de cada partida del Libro Diario:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ .jh  [encabezado: nÃºmero Â· tÃ­tulo Â· etiqueta IVA]   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚CÃ³digo â”‚ Nombre de la cuenta         â”‚ Debe  â”‚ Haber â”‚  â† tabla .jt
   â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚       â”‚   â†³ cuenta con sangrÃ­a      â”‚       â”‚       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚ .jf  [pie: totales Debe / Haber]                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Clases de celdas de la tabla:
   .dr â†’ monto en el Debe   (rojo, derecha, monoespaciado)
   .cr â†’ monto en el Haber  (verde, derecha, monoespaciado)
   .em â†’ celda vacÃ­a        (guiÃ³n gris, derecha)
   .cd â†’ cÃ³digo de cuenta   (gris, monoespaciado)
   .ac â†’ nombre de cuenta   (texto blanco)
   .ac.ind â†’ nombre indentado con â†³ para cuentas del Haber
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.je           { margin-bottom: 18px; border-radius: 9px; overflow: hidden; border: 1px solid var(--border); }
.jh           { background: var(--ink3); padding: 11px 16px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid var(--border); }
.jn           { font-family: 'IBM Plex Mono', monospace; font-size: .68rem; color: var(--gold); background: var(--gold-dim); border: 1px solid rgba(201,168,76,.2); border-radius: 5px; padding: 2px 8px; }
.jt2          { font-weight: 600; font-size: .9rem; flex: 1; }
.jtag         { font-family: 'IBM Plex Mono', monospace; font-size: .67rem; border-radius: 5px; padding: 2px 8px; }
.jtag.i       { color: var(--credit); background: var(--credit-dim); border: 1px solid rgba(60,180,122,.2); }   /* Con IVA */
.jtag.n       { color: var(--text2);  background: rgba(255,255,255,.05); border: 1px solid var(--border); }     /* Sin IVA */
table.jt      { width: 100%; border-collapse: collapse; font-size: .85rem; }
table.jt thead th         { background: rgba(255,255,255,.03); padding: 8px 14px; text-align: left; font-size: .68rem; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text2); border-bottom: 1px solid var(--border); }
table.jt thead th.r       { text-align: right; }
table.jt tbody tr         { border-bottom: 1px solid rgba(255,255,255,.04); }
table.jt tbody tr:last-child { border-bottom: none; }
table.jt tbody td         { padding: 8px 14px; vertical-align: middle; }
.cd           { font-family: 'IBM Plex Mono', monospace; font-size: .76rem; color: var(--text2); }
.ac           { color: var(--text); }
.ac.ind       { padding-left: 22px; color: var(--text2); }
.ac.ind::before { content: 'â†³ '; color: var(--ledger-light); } /* Indicador visual de sangrÃ­a */
.dr           { text-align: right; font-family: 'IBM Plex Mono', monospace; font-weight: 700; color: var(--debit); }
.cr           { text-align: right; font-family: 'IBM Plex Mono', monospace; font-weight: 700; color: var(--credit); }
.em           { text-align: right; font-family: 'IBM Plex Mono', monospace; color: rgba(255,255,255,.12); }
/* Pie de la partida con totales Debe / Haber (deben ser iguales â†’ partida balanceada) */
.jf           { background: rgba(255,255,255,.03); border-top: 2px solid rgba(255,255,255,.1); padding: 9px 16px; display: flex; justify-content: flex-end; gap: 36px; font-family: 'IBM Plex Mono', monospace; font-size: .8rem; }
.jfi          { display: flex; gap: 10px; align-items: center; }
.jfl          { color: var(--text2); font-size: .68rem; letter-spacing: 1px; text-transform: uppercase; }
.jfd          { color: var(--debit);  font-weight: 700; }
.jfc          { color: var(--credit); font-weight: 700; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: CUENTAS T (LIBRO MAYOR)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RepresentaciÃ³n visual del formato "T" de las cuentas del mayor.
   Estructura de cada cuenta:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ .thd  [cÃ³digo Â· nombre Â· tipo]         â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚     DEBE      â”‚       HABER            â”‚
   â”‚ P1  $xxx      â”‚  $xxx  P2              â”‚
   â”‚ P3  $xxx      â”‚  Î£ Haber               â”‚
   â”‚ Î£ Debe        â”‚                        â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ .tftr  Saldo Deudor/Acreedor: $xxx     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   .tgrid â†’ cuadrÃ­cula responsiva de cuentas T
   .tc    â†’ tarjeta individual de una cuenta T
   .tcols â†’ divisiÃ³n en dos columnas (Debe | divisor | Haber)
   .tdiv  â†’ lÃ­nea divisora vertical de 1px
   .tent  â†’ cuerpo de cada columna con los movimientos
   .trow  â†’ fila de un movimiento (referencia + monto)
   .tsum  â†’ fila de subtotal al pie de cada columna
   .tftr  â†’ pie con saldo final de la cuenta
   
   Colores de etiqueta de tipo (.ttipo):
   Â· activo    â†’ verde
   Â· pasivo    â†’ rojo
   Â· patrimonio â†’ dorado
   Â· ingresos  â†’ azul claro
   Â· costos / gastos â†’ pÃºrpura
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tgrid  { display: grid; grid-template-columns: repeat(auto-fill, minmax(255px,1fr)); gap: 14px; }
.tc     { border: 1px solid var(--border); border-radius: 9px; overflow: hidden; background: var(--ink2); }
.thd    { background: var(--ink3); padding: 10px 13px; text-align: center; border-bottom: 2px solid var(--border); }
.tcode  { font-family: 'IBM Plex Mono', monospace; font-size: .68rem; color: var(--text2); display: block; }
.tname  { font-weight: 700; font-size: .86rem; color: var(--text); display: block; margin: 2px 0; }
.ttipo  { font-size: .68rem; display: inline-block; padding: 1px 8px; border-radius: 10px; margin-top: 2px; }
.ttipo.activo     { background: rgba(60,180,122,.15);  color: var(--credit); }
.ttipo.pasivo     { background: rgba(224,82,82,.12);   color: var(--debit); }
.ttipo.patrimonio { background: var(--gold-dim);        color: var(--gold); }
.ttipo.ingresos   { background: rgba(100,150,255,.12); color: #7aadff; }
.ttipo.costos,
.ttipo.gastos     { background: rgba(200,100,255,.1);  color: #c87aff; }
.tcols  { display: grid; grid-template-columns: 1fr 1px 1fr; }
.tch    { padding: 6px 10px; font-size: .67rem; letter-spacing: 1px; text-transform: uppercase; font-weight: 700; border-bottom: 1px solid var(--border); background: rgba(255,255,255,.02); }
.tch.dl { color: var(--debit); }           /* Encabezado "DEBE" en rojo */
.tch.cl { color: var(--credit); text-align: right; } /* Encabezado "HABER" en verde */
.tdiv   { background: var(--border); }    /* Divisor vertical entre columnas */
.tent   { padding: 8px 10px; min-height: 64px; }
.trow   { font-family: 'IBM Plex Mono', monospace; font-size: .75rem; display: flex; justify-content: space-between; align-items: center; padding: 2px 0; gap: 4px; }
.tref   { color: var(--text2); font-size: .67rem; flex-shrink: 0; } /* Referencia a la partida (P1, P2â€¦) */
.tad    { color: var(--debit);  font-weight: 700; } /* Monto en columna DEBE */
.tac    { color: var(--credit); font-weight: 700; } /* Monto en columna HABER */
.tsum   { border-top: 1px solid var(--border); margin-top: 5px; padding-top: 5px; display: flex; justify-content: space-between; align-items: center; }
.tsuml  { font-size: .65rem; color: var(--text2); text-transform: uppercase; letter-spacing: .5px; }
.tsvd   { font-weight: 700; font-size: .84rem; font-family: 'IBM Plex Mono', monospace; color: var(--debit); }   /* Î£ Debe */
.tsvc   { font-weight: 700; font-size: .84rem; font-family: 'IBM Plex Mono', monospace; color: var(--credit); }  /* Î£ Haber */
.tftr   { background: rgba(255,255,255,.03); border-top: 2px solid var(--border); padding: 8px 10px; display: flex; justify-content: space-between; align-items: center; }
.tsll   { font-size: .67rem; color: var(--text2); text-transform: uppercase; letter-spacing: .5px; }
.tslv   { font-family: 'IBM Plex Mono', monospace; font-weight: 800; font-size: .92rem; }
.tslv.d { color: var(--debit); }   /* Saldo deudor */
.tslv.c { color: var(--credit); }  /* Saldo acreedor */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPONENTE: LIQUIDACIÃ“N DE IVA
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SecciÃ³n de resultados del IVA. Estructura:
   
   [KPI 1: CF Total] [KPI 2: DF Total] [KPI 3: Resultado]
   
   Tabla de desglose por operaciÃ³n:
   # | OperaciÃ³n | Base | CF | DF
   
   FÃ³rmula visual:
   DÃ©bito Fiscal (ventas)         + $1,430.00
   CrÃ©dito Fiscal (compras)       âˆ’ $962.00
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   IVA a enterar al fisco         = $468.00
   
   Banner de resultado: rojo si hay que pagar, verde si hay remanente.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* CuadrÃ­cula de 3 KPIs (indicadores clave) */
.iva-kpi { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; margin-bottom: 22px; }
@media(max-width:600px) { .iva-kpi { grid-template-columns: 1fr; } }

.kpi    { border-radius: 10px; padding: 20px; text-align: center; border: 1px solid; }
.kpi.cf { background: var(--credit-dim); border-color: rgba(60,180,122,.25); }    /* CrÃ©dito Fiscal â†’ verde */
.kpi.df { background: var(--debit-dim);  border-color: rgba(224,82,82,.25); }     /* DÃ©bito Fiscal  â†’ rojo */
.kpi.re { background: var(--gold-dim);   border-color: rgba(201,168,76,.25); }    /* Resultado      â†’ dorado */
.kl     { font-size: .68rem; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; margin-bottom: 8px; }
.kpi.cf .kl { color: var(--credit); }
.kpi.df .kl { color: var(--debit); }
.kpi.re .kl { color: var(--gold); }
.kv     { font-family: 'Libre Baskerville', serif; font-size: 1.9rem; font-weight: 700; }
.kpi.cf .kv { color: var(--credit); }
.kpi.df .kv { color: var(--debit); }
.kpi.re .kv { color: var(--gold); }
.ks     { font-size: .73rem; color: var(--text2); margin-top: 5px; }

/* Tabla de desglose por operaciÃ³n */
.idt              { width: 100%; border-collapse: collapse; font-size: .84rem; margin-bottom: 18px; }
.idt thead th     { background: var(--ink3); padding: 9px 13px; text-align: left; font-size: .68rem; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text2); border-bottom: 1px solid var(--border); }
.idt thead th.r   { text-align: right; }
.idt tbody tr     { border-bottom: 1px solid rgba(255,255,255,.04); }
.idt tbody tr:hover { background: rgba(255,255,255,.02); }
.idt tbody td     { padding: 8px 13px; vertical-align: middle; }
.idt tfoot td     { padding: 10px 13px; font-weight: 700; background: rgba(255,255,255,.04); border-top: 2px solid rgba(255,255,255,.1); }
.vcf { text-align: right; font-family: 'IBM Plex Mono', monospace; font-weight: 700; color: var(--credit); } /* Valor CF */
.vdf { text-align: right; font-family: 'IBM Plex Mono', monospace; font-weight: 700; color: var(--debit);  } /* Valor DF */
.vb  { text-align: right; font-family: 'IBM Plex Mono', monospace; color: var(--text2); }                    /* Base imponible */
.vd  { text-align: right; color: rgba(255,255,255,.12); font-family: 'IBM Plex Mono', monospace; }           /* Celda vacÃ­a */

/* Caja de fÃ³rmula de liquidaciÃ³n */
.fbox { background: var(--ink3); border: 1px solid var(--border); border-radius: 9px; padding: 18px; font-family: 'IBM Plex Mono', monospace; font-size: .82rem; line-height: 2; }
.frow { display: flex; justify-content: space-between; align-items: center; padding: 3px 0; }
.fsep { border-top: 1px solid rgba(255,255,255,.1); margin: 6px 0; } /* LÃ­nea separadora horizontal */
.fl   { color: var(--text2); }
.fvcf { color: var(--credit); font-weight: 700; } /* Valor CF en fÃ³rmula */
.fvdf { color: var(--debit);  font-weight: 700; } /* Valor DF en fÃ³rmula */
.fvr  { color: var(--gold);   font-weight: 800; font-size: .95rem; } /* Resultado final */

/* Banner de resultado (condicional) */
.banner   { border-radius: 10px; padding: 18px 22px; display: flex; align-items: center; gap: 14px; margin-top: 14px; font-size: .92rem; font-weight: 600; }
.banner.p { background: rgba(224,82,82,.1);    border: 1px solid rgba(224,82,82,.3);    color: #f07070; }  /* Pagar al fisco */
.banner.f { background: var(--credit-dim);     border: 1px solid rgba(60,180,122,.3);   color: var(--credit); } /* Remanente a favor */
.bico     { font-size: 1.5rem; flex-shrink: 0; }

/* Tabla del catÃ¡logo de cuentas */
.catt              { width: 100%; border-collapse: collapse; font-size: .84rem; }
.catt thead th     { background: var(--ink3); padding: 9px 14px; text-align: left; font-size: .68rem; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text2); border-bottom: 1px solid var(--border); }
.catt tbody tr     { border-bottom: 1px solid rgba(255,255,255,.04); }
.catt tbody tr:hover td { background: rgba(255,255,255,.02); }
.catt tbody td     { padding: 8px 14px; }

/* Utilidades */
.empty  { text-align: center; padding: 50px 20px; color: var(--text2); }
footer  { text-align: center; color: var(--text2); font-size: .76rem; padding: 22px; border-top: 1px solid var(--border); }

/* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   < 640px: la grilla de operaciones pasa a 2 columnas.
            La fila de apertura se apila verticalmente.
   < 420px: la grilla pasa a 1 columna (pantallas muy pequeÃ±as).
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media(max-width:640px) { .ops-grid { grid-template-columns: 1fr 1fr; } .apert-row { flex-direction: column; } }
@media(max-width:420px) { .ops-grid { grid-template-columns: 1fr; } }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ENCABEZADO PRINCIPAL
     Barra fija con nombre de la aplicaciÃ³n y etiquetas.
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header class="hdr">
  <div class="logo">
    <div class="logo-icon">ğŸ“’</div>
    <div>
      <span class="logo-name">Libro Diario SV</span>
      <span class="logo-sub">Sistema Contable Â· El Salvador</span>
    </div>
  </div>
  <div class="hdr-badges">
    <span class="pill pill-g">IVA 13%</span>
    <span class="pill pill-a">CrÃ©dito &amp; DÃ©bito Fiscal</span>
  </div>
</header>

<div class="wrap">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SECCIÃ“N 1: FORMULARIO DE ENTRADA
       Contiene: campo de apertura + 9 tarjetas de operaciones.
       El botÃ³n llama a calcular() al ser presionado.
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="card">
    <div class="card-head">
      <div>
        <div class="card-lbl">Datos a ingresar</div>
        <div class="card-ttl">Ingresa los montos de cada operaciÃ³n</div>
      </div>
    </div>

    <!-- OperaciÃ³n 0: Apertura (sin IVA, trato especial) -->
    <div class="apert-row">
      <span class="apert-lbl">â¬¡ Apertura â€” Aporte inicial de socios</span>
      <div class="iw" style="flex:1;min-width:160px;max-width:220px;">
        <span class="ipfx">$</span>
        <!-- id="f_a" â†’ identificado como f_apertura en el JS -->
        <input class="field" type="number" id="f_a" value="50000" min="0" step="0.01">
      </div>
      <span class="pill pill-a" style="font-size:.68rem;white-space:nowrap;">Sin IVA Â· Capital</span>
    </div>

    <!-- Operaciones 1â€“9: generadas dinÃ¡micamente por renderOps() -->
    <div class="ops-grid" id="ops-grid"></div>

    <!-- BotÃ³n principal de cÃ¡lculo -->
    <button class="calc-btn" onclick="calcular()">
      <span style="font-size:1.1rem;">âŸ³</span> Calcular â€” Libro Diario Â· Cuentas T Â· LiquidaciÃ³n IVA
    </button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SECCIÃ“N 2: RESULTADOS (oculta hasta ejecutar calcular())
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="results" style="display:none;">

    <!-- â”€â”€ TARJETA: LIQUIDACIÃ“N DE IVA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         Primera secciÃ³n visible al calcular (scroll automÃ¡tico).
         Muestra: KPIs Â· tabla desglose Â· fÃ³rmula Â· banner.
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="card" id="iva-card">
      <div class="card-head">
        <div>
          <div class="card-lbl">Resultado del PerÃ­odo</div>
          <div class="card-ttl">LiquidaciÃ³n de IVA (13%)</div>
        </div>
      </div>

      <!-- KPIs: CF | DF | Resultado â€” rellenados por calcular() -->
      <div class="iva-kpi" id="kpis"></div>

      <div style="margin-bottom:8px;font-size:.78rem;color:var(--text2);">Desglose por operaciÃ³n:</div>

      <!-- Tabla de desglose operaciÃ³n a operaciÃ³n -->
      <div style="overflow-x:auto;border-radius:9px;border:1px solid var(--border);margin-bottom:20px;">
        <table class="idt">
          <thead>
            <tr>
              <th style="width:36px">#</th>
              <th>OperaciÃ³n</th>
              <th class="r">Base Imponible</th>
              <th class="r">CF â€” CrÃ©dito Fiscal (Compras)</th>
              <th class="r">DF â€” DÃ©bito Fiscal (Ventas)</th>
            </tr>
          </thead>
          <tbody id="iva-body"></tbody>   <!-- Filas de datos por operaciÃ³n -->
          <tfoot id="iva-foot"></tfoot>   <!-- Fila de totales -->
        </table>
      </div>

      <div style="margin-bottom:10px;font-size:.78rem;color:var(--text2);">FÃ³rmula de liquidaciÃ³n:</div>
      <!-- Caja con la fÃ³rmula: DF âˆ’ CF = Resultado -->
      <div class="fbox" id="formula"></div>
      <!-- Banner condicional: rojo (pagar) o verde (remanente) -->
      <div id="banner"></div>
    </div>

    <!-- â”€â”€ SISTEMA DE PESTAÃ‘AS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         Tres vistas del mismo conjunto de datos contables.
         showTab() controla cuÃ¡l panel es visible.
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="tabs">
      <button class="tab on" onclick="showTab('t-j',this)">ğŸ“‹ Libro Diario</button>
      <button class="tab"    onclick="showTab('t-m',this)">âŠ Cuentas T (Mayor)</button>
      <button class="tab"    onclick="showTab('t-c',this)">ğŸ“‘ CatÃ¡logo</button>
    </div>

    <!-- Panel: Libro Diario â€” partidas generadas por mkEntry() -->
    <div id="t-j" class="panel on">
      <div id="j-out"></div>
    </div>

    <!-- Panel: Cuentas T â€” cuadrÃ­cula generada en calcular() -->
    <div id="t-m" class="panel">
      <div class="tgrid" id="m-out"></div>
    </div>

    <!-- Panel: CatÃ¡logo de cuentas â€” tabla generada en calcular() -->
    <div id="t-c" class="panel">
      <div style="overflow-x:auto;border-radius:9px;border:1px solid var(--border);">
        <table class="catt">
          <thead>
            <tr><th>CÃ³digo</th><th>Cuenta</th><th>Tipo</th><th>Naturaleza</th></tr>
          </thead>
          <tbody id="c-out"></tbody>
        </table>
      </div>
    </div>

  </div><!-- /results -->
</div><!-- /wrap -->

<footer>
  LibroDiario SV Â· Herramienta educativa de contabilidad Â· Â© 2026 MIGUEL ANTONIO HERRERA CHAVEZ Â· Universidad Gerardo Barrios
</footer>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MÃ“DULO JAVASCRIPT â€” LÃ“GICA DE LA APLICACIÃ“N
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   ARQUITECTURA GENERAL:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  DATOS            CUENTAS, OPS, IVA = 0.13                  â”‚
   â”‚  ESTADO           ledger (objeto global del Mayor)           â”‚
   â”‚  UTILIDADES       fmt(), gv(), swOn(), addMov()             â”‚
   â”‚  RENDERIZADO      renderOps(), mkEntry()                    â”‚
   â”‚  CÃLCULO CENTRAL  calcular()                                â”‚
   â”‚  UI               showTab(), toggleSw()                     â”‚
   â”‚  INICIO           renderOps() + setTimeout(calcular, 80)    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   FLUJO DE EJECUCIÃ“N:
   1. renderOps()    â†’ dibuja las 9 tarjetas de input en el DOM
   2. setTimeout()   â†’ espera 80ms para que el DOM estÃ© listo
   3. calcular()     â†’ lee valores, genera partidas, actualiza DOM
      â”œâ”€â”€ Para cada operaciÃ³n con monto > 0:
      â”‚     a. Calcula IVA si aplica
      â”‚     b. Construye array de filas (rows) con cÃ³digo/lado/monto
      â”‚     c. reg(rows) â†’ registra en ledger (Libro Mayor)
      â”‚     d. entries.push(mkEntry(...)) â†’ genera HTML de la partida
      â”‚     e. ivaRows.push({...}) â†’ acumula datos para liquidaciÃ³n IVA
      â”œâ”€â”€ Calcula totales CF, DF y resultado
      â””â”€â”€ Actualiza todos los contenedores del DOM
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* â”€â”€ CONSTANTE: TASA IVA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   El Salvador aplica IVA del 13% a la mayorÃ­a de bienes y servicios.
   Se define como constante para facilitar actualizaciÃ³n futura.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const IVA = 0.13;

/* â”€â”€ CATÃLOGO DE CUENTAS (Plan de Cuentas) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Objeto indexado por cÃ³digo de cuenta (nÃºmero entero â†’ string key).
   Cada entrada contiene:
   Â· n   = nombre completo de la cuenta
   Â· t   = tipo (Activo, Pasivo, Patrimonio, Ingresos, Costos, Gastos)
   Â· nat = naturaleza (Deudora = saldo normal en el Debe)
                      (Acreedora = saldo normal en el Haber)
   
   REGLA DE ORO: Activos y Gastos son Deudores.
                 Pasivos, Patrimonio e Ingresos son Acreedores.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const CUENTAS = {
  1101: { n: 'Efectivo y Equivalentes',       t: 'Activo',     nat: 'Deudora'   },
  1103: { n: 'Cuentas por Cobrar Clientes',   t: 'Activo',     nat: 'Deudora'   },
  1104: { n: 'IVA CrÃ©dito Fiscal (13%)',      t: 'Activo',     nat: 'Deudora'   }, /* IVA pagado en compras â†’ activo recuperable */
  1105: { n: 'Inventarios',                   t: 'Activo',     nat: 'Deudora'   },
  1201: { n: 'Propiedad, Planta y Equipo',    t: 'Activo',     nat: 'Deudora'   },
  2101: { n: 'Cuentas por Pagar Proveedores', t: 'Pasivo',     nat: 'Acreedora' },
  2102: { n: 'IVA DÃ©bito Fiscal (13%)',       t: 'Pasivo',     nat: 'Acreedora' }, /* IVA cobrado en ventas â†’ pasivo por pagar al fisco */
  3101: { n: 'Capital Social',               t: 'Patrimonio', nat: 'Acreedora' },
  4101: { n: 'Ventas',                        t: 'Ingresos',   nat: 'Acreedora' },
  4102: { n: 'Dev. y Rebajas s/Ventas',       t: 'Ingresos',   nat: 'Deudora'   }, /* Contra-ingreso (naturaleza contraria) */
  5101: { n: 'Compras',                       t: 'Costos',     nat: 'Deudora'   },
  5102: { n: 'Gastos de Venta',               t: 'Gastos',     nat: 'Deudora'   },
};

/* â”€â”€ DEFINICIÃ“N DE OPERACIONES (OPS) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Array con la configuraciÃ³n de cada operaciÃ³n del ejercicio.
   Se usa en renderOps() para generar dinÃ¡micamente las tarjetas de input.
   Propiedades:
   Â· id   = identificador numÃ©rico (1â€“9)
   Â· lbl  = nombre descriptivo de la operaciÃ³n
   Â· hint = contexto adicional mostrado bajo el input
   Â· def  = valor por defecto (monto del ejercicio de clase)
   Â· iva  = boolean â†’ si aplica IVA por defecto (toggle inicial)
   
   NOTA: Operaciones 5 y 8 tienen iva:false porque son movimientos
   financieros que no generan nuevos hechos econÃ³micos gravados.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const OPS = [
  { id:1, lbl:'Compra de Mobiliario',  hint:'Al contado',         def:2000, iva:true  },
  { id:2, lbl:'Compra de MercancÃ­a',   hint:'Al crÃ©dito',         def:5000, iva:true  },
  { id:3, lbl:'Venta al Contado',      hint:'En efectivo',        def:8000, iva:true  },
  { id:4, lbl:'Venta al CrÃ©dito',      hint:'PagarÃ© del cliente', def:3000, iva:true  },
  { id:5, lbl:'Pago a Proveedores',    hint:'Abono deuda Op.2',   def:2000, iva:false }, /* No genera IVA: es cancelaciÃ³n de deuda */
  { id:6, lbl:'DevoluciÃ³n s/ Compra',  hint:'MercancÃ­a defec.',   def:500,  iva:true  },
  { id:7, lbl:'Pago de Alquiler',      hint:'Con cheque',         def:600,  iva:true  },
  { id:8, lbl:'Cobro a Clientes',      hint:'Efectivo Op.4',      def:1500, iva:false }, /* No genera IVA: es cobro de deuda ya registrada */
  { id:9, lbl:'Gasto de Publicidad',   hint:'Radio, al contado',  def:300,  iva:true  },
];

/* â”€â”€ UTILIDADES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   fmt(n)     â†’ Formatea un nÃºmero como moneda USD: "$1,234.56"
                Usa Math.abs() para evitar el signo negativo.
                toLocaleString() con locale 'en-US' para separadores.
   
   gv(id)     â†’ Get Value: lee el valor numÃ©rico del input con ese id.
                Retorna 0 si el campo estÃ¡ vacÃ­o o no existe (?.).
   
   swOn(id)   â†’ Switch On: retorna true si el toggle de IVA estÃ¡ activo.
                Verifica si el div tiene la clase 'on'.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const fmt  = n  => '$' + Math.abs(n).toLocaleString('en-US', { minimumFractionDigits:2, maximumFractionDigits:2 });
const gv   = id => parseFloat(document.getElementById(id)?.value) || 0;
const swOn = id => document.getElementById('sw' + id)?.classList.contains('on');

/* â”€â”€ LIBRO MAYOR (LEDGER) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Objeto global que simula el Libro Mayor contable.
   Estructura: { [cÃ³digo_cuenta]: { d: [...movimientos], c: [...movimientos] } }
   
   Cada movimiento es: { amount: nÃºmero, ref: string }
   Â· amount = monto del movimiento
   Â· ref    = referencia a la partida origen ("P1", "P2", etc.)
   
   Se reinicia en cada llamada a calcular() para evitar acumulaciÃ³n.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let ledger = {};

/**
 * addMov â€” Agrega un movimiento al Libro Mayor
 * @param {number|string} code   - CÃ³digo de la cuenta (ej: 1101)
 * @param {string}        side   - Lado: 'd' = Debe, 'c' = Haber
 * @param {number}        amount - Monto del movimiento (siempre positivo)
 * @param {string}        ref    - Referencia de la partida (ej: "P3")
 */
function addMov(code, side, amount, ref) {
  /* Inicializa la cuenta en el mayor si no existe todavÃ­a */
  if (!ledger[code]) ledger[code] = { d: [], c: [] };
  /* Agrega el movimiento al array correspondiente (Debe o Haber) */
  ledger[code][side === 'd' ? 'd' : 'c'].push({ amount, ref });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FUNCIÃ“N: renderOps()
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROPÃ“SITO: Genera dinÃ¡micamente las 9 tarjetas de input en el DOM.
   
   Por cada elemento del array OPS, crea un bloque HTML con:
   Â· NÃºmero e insignia de la operaciÃ³n
   Â· Input numÃ©rico con valor predeterminado del ejercicio
   Â· Toggle de IVA (activado/desactivado segÃºn config)
   Â· Hint descriptivo del contexto de la operaciÃ³n
   
   IDs generados en el DOM:
   Â· f{id}       â†’ input del monto (ej: f1, f2 ... f9)
   Â· sw{id}      â†’ div del toggle  (ej: sw1, sw2 ... sw9)
   Â· swtxt{id}   â†’ span del texto del toggle
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderOps() {
  document.getElementById('ops-grid').innerHTML = OPS.map(o => `
    <div class="op-block">
      <div class="op-head">
        <div class="op-num">${o.id}</div>
        <div class="op-ttl">${o.lbl}</div>
      </div>
      <!-- Input numÃ©rico con prefijo "$" posicionado absolutamente -->
      <div class="iw">
        <span class="ipfx">$</span>
        <input class="field" type="number" id="f${o.id}" value="${o.def}" min="0" step="0.01">
      </div>
      <div class="op-meta">
        <span class="iva-lbl">${o.hint}</span>
        <!-- Toggle de IVA: onclick llama toggleSw() con el id de la operaciÃ³n -->
        <div class="tw" onclick="toggleSw(${o.id})">
          <div class="sw ${o.iva ? 'on' : ''}" id="sw${o.id}">
            <div class="sw-k"></div>
          </div>
          <span class="iva-lbl" id="swtxt${o.id}">IVA: ${o.iva ? '13%' : 'No'}</span>
        </div>
      </div>
    </div>`).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FUNCIÃ“N: toggleSw(id)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROPÃ“SITO: Cambia el estado del toggle de IVA de una operaciÃ³n.
   
   Alterna la clase 'on' en el div del toggle.
   Actualiza el texto descriptivo ("IVA: 13%" / "IVA: No").
   
   @param {number} id - ID de la operaciÃ³n (1â€“9)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleSw(id) {
  const s = document.getElementById('sw' + id);
  const t = document.getElementById('swtxt' + id);
  s.classList.toggle('on');
  t.textContent = 'IVA: ' + (s.classList.contains('on') ? '13%' : 'No');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FUNCIÃ“N: mkEntry(num, title, rows, applyIva)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROPÃ“SITO: Genera el HTML de una partida de Diario.
   
   @param {number}   num      - NÃºmero secuencial de la partida
   @param {string}   title    - DescripciÃ³n de la operaciÃ³n
   @param {Array}    rows     - Array de lÃ­neas contables:
                                [{ code, side, amt, ind? }, ...]
                                Â· code = cÃ³digo de cuenta (ej: 1101)
                                Â· side = 'd' (Debe) | 'c' (Haber)
                                Â· amt  = monto
                                Â· ind  = true si lleva sangrÃ­a (â†³)
   @param {boolean}  applyIva - true = etiqueta "+ IVA 13%"
   @returns {string} HTML de la partida completa
   
   VERIFICACIÃ“N DE BALANCE: Los totales de Debe y Haber deben ser
   iguales (principio de partida doble). Se muestran en el pie.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function mkEntry(num, title, rows, applyIva) {
  /* Suma todos los montos del Debe y del Haber por separado */
  const totD = rows.filter(r => r.side === 'd').reduce((a,r) => a + r.amt, 0);
  const totC = rows.filter(r => r.side === 'c').reduce((a,r) => a + r.amt, 0);
  return `
  <div class="je">
    <div class="jh">
      <span class="jn">Partida ${num}</span>
      <span class="jt2">${title}</span>
      <!-- Etiqueta condicional: verde con IVA / gris sin IVA -->
      <span class="jtag ${applyIva ? 'i' : 'n'}">${applyIva ? '+ IVA 13%' : 'Sin IVA'}</span>
    </div>
    <table class="jt">
      <thead>
        <tr>
          <th style="width:74px">CÃ³digo</th>
          <th>Cuenta</th>
          <th class="r">Debe</th>
          <th class="r">Haber</th>
        </tr>
      </thead>
      <tbody>
        ${rows.map(r => `
        <tr>
          <td class="cd">${r.code}</td>
          <!-- Busca el nombre en CUENTAS; aplica sangrÃ­a si ind=true -->
          <td class="ac${r.ind ? ' ind' : ''}">${CUENTAS[r.code]?.n || ''}</td>
          <!-- Muestra monto en Debe (rojo) o guiÃ³n vacÃ­o -->
          <td class="${r.side === 'd' ? 'dr' : 'em'}">${r.side === 'd' ? fmt(r.amt) : 'â€”'}</td>
          <!-- Muestra monto en Haber (verde) o guiÃ³n vacÃ­o -->
          <td class="${r.side === 'c' ? 'cr' : 'em'}">${r.side === 'c' ? fmt(r.amt) : 'â€”'}</td>
        </tr>`).join('')}
      </tbody>
    </table>
    <!-- Pie: totales deben ser iguales (partida balanceada) -->
    <div class="jf">
      <div class="jfi"><span class="jfl">Debe</span><span class="jfd">${fmt(totD)}</span></div>
      <div class="jfi"><span class="jfl">Haber</span><span class="jfc">${fmt(totC)}</span></div>
    </div>
  </div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FUNCIÃ“N PRINCIPAL: calcular()
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROPÃ“SITO: NÃºcleo de la aplicaciÃ³n. Ejecuta el ciclo contable
   completo y actualiza todos los elementos del DOM.
   
   PROCESO:
   1. Reinicia el ledger y las colecciones de resultados
   2. Lee todos los valores del formulario
   3. Para cada operaciÃ³n con monto > 0:
      a. Calcula el IVA si el toggle estÃ¡ activado
      b. Construye el array de filas (rows) de la partida
      c. Registra en el ledger via reg(rows)
      d. Genera el HTML de la partida con mkEntry()
      e. Acumula el IVA en ivaRows para la liquidaciÃ³n
   4. Calcula totales de CF y DF
   5. Actualiza el DOM: KPIs, tabla IVA, fÃ³rmula, banner, diario, mayor, catÃ¡logo
   6. Muestra la secciÃ³n de resultados y hace scroll al KPI de IVA
   
   ESTRUCTURA DE ROWS (filas de una partida):
   [
     { code: 1201, side: 'd', amt: 2000 },        â† Debe (sin sangrÃ­a)
     { code: 1104, side: 'd', amt: 260  },        â† Debe (sin sangrÃ­a)
     { code: 1101, side: 'c', amt: 2260, ind: true } â† Haber (con sangrÃ­a)
   ]
   
   ESTRUCTURA DE IVAROWS (seguimiento del IVA):
   {
     num    : nÃºmero o letra de la operaciÃ³n
     lbl    : etiqueta descriptiva
     base   : monto sin IVA (base imponible)
     cf     : IVA CrÃ©dito Fiscal (compras) â€” positivo o negativo (reverso)
     df     : IVA DÃ©bito Fiscal (ventas) â€” siempre positivo o cero
     noIva  : true si la operaciÃ³n no genera IVA
     dev    : true si es una devoluciÃ³n (reverso del CF)
   }
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function calcular() {
  /* Reinicia el libro mayor y las colecciones de resultados */
  ledger = {};
  const entries  = []; /* Almacena el HTML de cada partida de diario */
  const ivaRows  = []; /* Acumula datos de IVA por operaciÃ³n */
  let   p        = 0;  /* Contador secuencial de partidas */

  /**
   * reg(rows) â€” Registra un conjunto de filas en el Libro Mayor
   * FunciÃ³n interna que usa el valor actual de 'p' como referencia.
   * @param {Array} rows - Filas de la partida actual
   */
  function reg(rows) {
    rows.forEach(r => addMov(r.code, r.side, r.amt, 'P' + p));
  }

  /* â”€â”€â”€ OPERACIÃ“N 0: APERTURA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Aporte de capital de los socios en efectivo.
     Â· No genera IVA (es una transacciÃ³n de capital, no comercial)
     Â· DEBE: 1101 Efectivo (aumenta activo)
     Â· HABER: 3101 Capital Social (aumenta patrimonio)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const va = gv('f_a');
  if (va > 0) {
    p++;
    const rows = [
      { code: 1101, side: 'd', amt: va },             /* Efectivo recibido */
      { code: 3101, side: 'c', amt: va, ind: true },  /* Capital aportado */
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Apertura â€” Aporte Inicial de Socios', rows, false));
    ivaRows.push({ num:'A', lbl:'Apertura (Capital)', base:0, cf:0, df:0, noIva:true });
  }

  /* â”€â”€â”€ OPERACIÃ“N 1: COMPRA DE MOBILIARIO (al contado) â”€â”€â”€â”€â”€â”€â”€â”€
     AdquisiciÃ³n de equipo de oficina. Pago inmediato en efectivo.
     Â· IVA: genera CrÃ©dito Fiscal (activo recuperable)
     Â· DEBE: 1201 Propiedad/Planta/Equipo (sin IVA, valor del bien)
     Â· DEBE: 1104 IVA CrÃ©dito Fiscal (IVA pagado)
     Â· HABER: 1101 Efectivo (pago total con IVA incluido)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v1 = gv('f1'), i1 = swOn(1);
  if (v1 > 0) {
    p++;
    const cf  = i1 ? v1 * IVA : 0;   /* CrÃ©dito Fiscal = base Ã— 13% */
    const tot = v1 + cf;               /* Total a pagar (base + IVA) */
    const rows = [
      { code: 1201, side: 'd', amt: v1 },
      ...(i1 ? [{ code: 1104, side: 'd', amt: cf }] : []),  /* Solo si aplica IVA */
      { code: 1101, side: 'c', amt: tot, ind: true },
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Compra de Mobiliario (al contado)', rows, i1));
    ivaRows.push({ num:1, lbl:'Compra de Mobiliario', base:v1, cf, df:0, noIva:!i1 });
  }

  /* â”€â”€â”€ OPERACIÃ“N 2: COMPRA DE MERCANCÃA (al crÃ©dito) â”€â”€â”€â”€â”€â”€â”€â”€â”€
     AdquisiciÃ³n de inventario para la venta. Pago diferido.
     Â· IVA: genera CrÃ©dito Fiscal
     Â· DEBE: 5101 Compras (costo de la mercancÃ­a sin IVA)
     Â· DEBE: 1104 IVA CrÃ©dito Fiscal
     Â· HABER: 2101 Cuentas por Pagar (total con IVA â†’ deuda al proveedor)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v2 = gv('f2'), i2 = swOn(2);
  if (v2 > 0) {
    p++;
    const cf  = i2 ? v2 * IVA : 0;
    const tot = v2 + cf;
    const rows = [
      { code: 5101, side: 'd', amt: v2 },
      ...(i2 ? [{ code: 1104, side: 'd', amt: cf }] : []),
      { code: 2101, side: 'c', amt: tot, ind: true },
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Compra de MercancÃ­a (al crÃ©dito)', rows, i2));
    ivaRows.push({ num:2, lbl:'Compra de MercancÃ­a', base:v2, cf, df:0, noIva:!i2 });
  }

  /* â”€â”€â”€ OPERACIÃ“N 3: VENTA AL CONTADO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Venta de mercancÃ­a con cobro inmediato en efectivo.
     Â· IVA: genera DÃ©bito Fiscal (pasivo por pagar al fisco)
     Â· DEBE: 1101 Efectivo (cobro total con IVA)
     Â· HABER: 4101 Ventas (ingreso sin IVA â†’ base de la venta)
     Â· HABER: 2102 IVA DÃ©bito Fiscal (IVA cobrado al cliente)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v3 = gv('f3'), i3 = swOn(3);
  if (v3 > 0) {
    p++;
    const df  = i3 ? v3 * IVA : 0;   /* DÃ©bito Fiscal = base Ã— 13% */
    const tot = v3 + df;
    const rows = [
      { code: 1101, side: 'd', amt: tot },
      { code: 4101, side: 'c', amt: v3,  ind: true },
      ...(i3 ? [{ code: 2102, side: 'c', amt: df, ind: true }] : []),
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Venta al Contado (efectivo)', rows, i3));
    ivaRows.push({ num:3, lbl:'Venta al Contado', base:v3, cf:0, df, noIva:!i3 });
  }

  /* â”€â”€â”€ OPERACIÃ“N 4: VENTA AL CRÃ‰DITO (pagarÃ©) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Venta de mercancÃ­a con cobro diferido (el cliente firma un pagarÃ©).
     Â· IVA: genera DÃ©bito Fiscal (se reconoce en el momento de la venta,
             no del cobro â†’ principio de devengado)
     Â· DEBE: 1103 Cuentas por Cobrar (total con IVA â†’ derecho de cobro)
     Â· HABER: 4101 Ventas
     Â· HABER: 2102 IVA DÃ©bito Fiscal
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v4 = gv('f4'), i4 = swOn(4);
  if (v4 > 0) {
    p++;
    const df  = i4 ? v4 * IVA : 0;
    const tot = v4 + df;
    const rows = [
      { code: 1103, side: 'd', amt: tot },
      { code: 4101, side: 'c', amt: v4,  ind: true },
      ...(i4 ? [{ code: 2102, side: 'c', amt: df, ind: true }] : []),
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Venta al CrÃ©dito (pagarÃ©)', rows, i4));
    ivaRows.push({ num:4, lbl:'Venta al CrÃ©dito', base:v4, cf:0, df, noIva:!i4 });
  }

  /* â”€â”€â”€ OPERACIÃ“N 5: PAGO A PROVEEDORES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Abono parcial a la deuda originada en la OperaciÃ³n 2.
     Â· SIN IVA: el IVA ya fue registrado en la Op.2. No se duplica.
     Â· DEBE: 2101 Cuentas por Pagar (reduce el pasivo)
     Â· HABER: 1101 Efectivo (sale dinero de caja)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v5 = gv('f5');
  if (v5 > 0) {
    p++;
    const rows = [
      { code: 2101, side: 'd', amt: v5 },
      { code: 1101, side: 'c', amt: v5, ind: true },
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Pago a Proveedores (abono)', rows, false));
    ivaRows.push({ num:5, lbl:'Pago a Proveedores', base:0, cf:0, df:0, noIva:true });
  }

  /* â”€â”€â”€ OPERACIÃ“N 6: DEVOLUCIÃ“N SOBRE COMPRA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     DevoluciÃ³n de mercancÃ­a defectuosa al proveedor. REVERSO de Op.2.
     Â· IVA: se REVIERTE el CrÃ©dito Fiscal (ya no corresponde el crÃ©dito
             porque se devuelve la mercancÃ­a)
     Â· DEBE: 2101 Cuentas por Pagar (reduce la deuda en monto + IVA)
     Â· HABER: 5101 Compras (reduce las compras por el valor del bien)
     Â· HABER: 1104 IVA CrÃ©dito Fiscal (reverso del crÃ©dito â†’ negativo en CF)
     
     En ivaRows.cf se usa valor NEGATIVO porque reduce el CF acumulado.
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v6 = gv('f6'), i6 = swOn(6);
  if (v6 > 0) {
    p++;
    const cf  = i6 ? v6 * IVA : 0;
    const tot = v6 + cf;
    const rows = [
      { code: 2101, side: 'd', amt: tot },
      { code: 5101, side: 'c', amt: v6,  ind: true },
      ...(i6 ? [{ code: 1104, side: 'c', amt: cf, ind: true }] : []),
    ];
    reg(rows);
    entries.push(mkEntry(p, 'DevoluciÃ³n sobre Compra (defectos)', rows, i6));
    /* cf negativo: esta operaciÃ³n REDUCE el CrÃ©dito Fiscal acumulado */
    ivaRows.push({ num:6, lbl:'DevoluciÃ³n s/ Compra', base:v6, cf:-cf, df:0, noIva:!i6, dev:true });
  }

  /* â”€â”€â”€ OPERACIÃ“N 7: PAGO DE ALQUILER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Pago de arrendamiento del local comercial con cheque.
     Â· IVA: genera CrÃ©dito Fiscal (los servicios gravados tambiÃ©n generan CF)
     Â· DEBE: 5102 Gastos de Venta (gasto sin IVA â†’ valor real del servicio)
     Â· DEBE: 1104 IVA CrÃ©dito Fiscal
     Â· HABER: 1101 Efectivo (pago total con IVA por cheque)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v7 = gv('f7'), i7 = swOn(7);
  if (v7 > 0) {
    p++;
    const cf  = i7 ? v7 * IVA : 0;
    const tot = v7 + cf;
    const rows = [
      { code: 5102, side: 'd', amt: v7 },
      ...(i7 ? [{ code: 1104, side: 'd', amt: cf }] : []),
      { code: 1101, side: 'c', amt: tot, ind: true },
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Pago de Alquiler (cheque)', rows, i7));
    ivaRows.push({ num:7, lbl:'Pago de Alquiler', base:v7, cf, df:0, noIva:!i7 });
  }

  /* â”€â”€â”€ OPERACIÃ“N 8: COBRO A CLIENTES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Cobro parcial de la venta a crÃ©dito de la OperaciÃ³n 4.
     Â· SIN IVA: el DF ya fue registrado en la Op.4. No se duplica.
     Â· DEBE: 1101 Efectivo (entra dinero)
     Â· HABER: 1103 Cuentas por Cobrar (reduce el derecho de cobro)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v8 = gv('f8');
  if (v8 > 0) {
    p++;
    const rows = [
      { code: 1101, side: 'd', amt: v8 },
      { code: 1103, side: 'c', amt: v8, ind: true },
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Cobro a Clientes (efectivo)', rows, false));
    ivaRows.push({ num:8, lbl:'Cobro a Clientes', base:0, cf:0, df:0, noIva:true });
  }

  /* â”€â”€â”€ OPERACIÃ“N 9: GASTO DE PUBLICIDAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     Pago de pauta publicitaria en radio. Pago al contado.
     Â· IVA: genera CrÃ©dito Fiscal (servicio gravado)
     Â· DEBE: 5102 Gastos de Venta (gasto de publicidad sin IVA)
     Â· DEBE: 1104 IVA CrÃ©dito Fiscal
     Â· HABER: 1101 Efectivo (pago total con IVA)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const v9 = gv('f9'), i9 = swOn(9);
  if (v9 > 0) {
    p++;
    const cf  = i9 ? v9 * IVA : 0;
    const tot = v9 + cf;
    const rows = [
      { code: 5102, side: 'd', amt: v9 },
      ...(i9 ? [{ code: 1104, side: 'd', amt: cf }] : []),
      { code: 1101, side: 'c', amt: tot, ind: true },
    ];
    reg(rows);
    entries.push(mkEntry(p, 'Gasto de Publicidad (radio)', rows, i9));
    ivaRows.push({ num:9, lbl:'Gasto de Publicidad', base:v9, cf, df:0, noIva:!i9 });
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CÃLCULO DE LIQUIDACIÃ“N DE IVA
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     totalCF = suma de todos los CrÃ©ditos Fiscales del perÃ­odo
               (puede ser negativa si la devoluciÃ³n supera las compras)
     totalDF = suma de todos los DÃ©bitos Fiscales del perÃ­odo
     res     = DF âˆ’ CF
               > 0: empresa debe pagar la diferencia al fisco
               < 0: empresa tiene remanente de CF a favor
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  const totalCF = ivaRows.reduce((a, r) => a + r.cf, 0); /* Suma todos los CF (incluye negativos de Op.6) */
  const totalDF = ivaRows.reduce((a, r) => a + r.df, 0); /* Suma todos los DF */
  const res     = totalDF - totalCF;                      /* Resultado neto del perÃ­odo */

  /* â”€â”€ ACTUALIZAR DOM: KPIs de IVA â”€â”€ */
  document.getElementById('kpis').innerHTML = `
    <div class="kpi cf">
      <div class="kl">IVA CrÃ©dito Fiscal</div>
      <div class="kv">${fmt(totalCF)}</div>
      <div class="ks">IVA soportado en compras y gastos</div>
    </div>
    <div class="kpi df">
      <div class="kl">IVA DÃ©bito Fiscal</div>
      <div class="kv">${fmt(totalDF)}</div>
      <div class="ks">IVA repercutido en ventas</div>
    </div>
    <div class="kpi re">
      <div class="kl">${res >= 0 ? 'IVA a Pagar a hacienda' : 'Remanente a Favor'}</div>
      <div class="kv">${fmt(Math.abs(res))}</div>
      <div class="ks">DÃ©bito Fiscal âˆ’ CrÃ©dito Fiscal</div>
    </div>`;

  /* â”€â”€ ACTUALIZAR DOM: Tabla desglose IVA por operaciÃ³n â”€â”€ */
  document.getElementById('iva-body').innerHTML = ivaRows.map(r => `
    <tr>
      <td style="color:var(--text2);font-family:'IBM Plex Mono',monospace;font-size:.74rem;">${r.num}</td>
      <td style="color:var(--text);">
        ${r.lbl}
        ${r.dev ? '<span style="font-size:.67rem;color:var(--debit);">(Reverso)</span>' : ''}
      </td>
      <!-- Base imponible: muestra "Sin IVA" si la operaciÃ³n no genera IVA -->
      <td class="${(r.noIva && !r.dev) || r.base === 0 ? 'vd' : 'vb'}">
        ${(r.noIva && !r.dev) || r.base === 0 ? 'Sin IVA' : fmt(r.base)}
      </td>
      <!-- CF: negativo se muestra entre parÃ©ntesis (convenciÃ³n contable) -->
      <td class="${r.cf < 0 ? 'vdf' : r.cf > 0 ? 'vcf' : 'vd'}">
        ${r.cf < 0 ? '(' + fmt(Math.abs(r.cf)) + ')' : r.cf > 0 ? fmt(r.cf) : 'â€”'}
      </td>
      <td class="${r.df > 0 ? 'vdf' : 'vd'}">${r.df > 0 ? fmt(r.df) : 'â€”'}</td>
    </tr>`).join('');

  /* â”€â”€ ACTUALIZAR DOM: Fila de totales en el tfoot â”€â”€ */
  document.getElementById('iva-foot').innerHTML = `
    <tr>
      <td colspan="2" style="color:var(--text);font-size:.76rem;letter-spacing:.5px;text-transform:uppercase;">
        Totales del PerÃ­odo
      </td>
      <td class="vb">â€”</td>
      <td class="vcf">${fmt(totalCF)}</td>
      <td class="vdf">${fmt(totalDF)}</td>
    </tr>`;

  /* â”€â”€ ACTUALIZAR DOM: FÃ³rmula de liquidaciÃ³n â”€â”€ */
  document.getElementById('formula').innerHTML = `
    <div class="frow">
      <span class="fl">DÃ©bito Fiscal (ventas)</span>
      <span class="fvdf">+ ${fmt(totalDF)}</span>
    </div>
    <div class="frow">
      <span class="fl">CrÃ©dito Fiscal (compras / gastos)</span>
      <span class="fvcf">âˆ’ ${fmt(totalCF)}</span>
    </div>
    <div class="fsep"></div>
    <div class="frow">
      <span class="fl" style="font-weight:700;">
        ${res >= 0 ? 'IVA a enterar al fisco' : 'Remanente CF a favor'}
      </span>
      <span class="fvr">= ${fmt(Math.abs(res))}</span>
    </div>`;

  /* â”€â”€ ACTUALIZAR DOM: Banner de resultado (condicional) â”€â”€ */
  document.getElementById('banner').innerHTML = res >= 0
    ? `<div class="banner p">
         <span class="bico">âš ï¸</span>
         <span>La empresa debe entregar <strong>${fmt(res)}</strong> a la DGII en concepto de IVA del perÃ­odo.
           <br><small style="font-weight:400;opacity:.85;">
             DÃ©bito Fiscal ${fmt(totalDF)} âˆ’ CrÃ©dito Fiscal ${fmt(totalCF)} = ${fmt(res)}
           </small>
         </span>
       </div>`
    : `<div class="banner f">
         <span class="bico">âœ…</span>
         <span>La empresa tiene un remanente de CrÃ©dito Fiscal de <strong>${fmt(Math.abs(res))}</strong>,
           aplicable al siguiente perÃ­odo de declaraciÃ³n.
         </span>
       </div>`;

  /* â”€â”€ ACTUALIZAR DOM: Libro Diario â”€â”€ */
  document.getElementById('j-out').innerHTML = entries.join('');

  /* â”€â”€ ACTUALIZAR DOM: Cuentas T (Libro Mayor) â”€â”€ */
  document.getElementById('m-out').innerHTML = Object.entries(ledger)
    .sort((a, b) => +a[0] - +b[0]) /* Ordena por cÃ³digo de cuenta (ascendente) */
    .map(([code, data]) => {
      const c    = CUENTAS[code] || { n:'Cuenta '+code, t:'N/D', nat:'Deudora' };
      const totD = data.d.reduce((a,r) => a + r.amount, 0); /* Total Debe */
      const totC = data.c.reduce((a,r) => a + r.amount, 0); /* Total Haber */
      const saldo = totD - totC; /* Saldo = Debe - Haber */
      /* Extrae la primera palabra del tipo para usarla como clase CSS */
      const tc = c.t.toLowerCase().split('(')[0].trim();
      return `
      <div class="tc">
        <div class="thd">
          <span class="tcode">${code}</span>
          <span class="tname">${c.n}</span>
          <span class="ttipo ${tc}">${c.t}</span>
        </div>
        <div class="tcols">
          <!-- Columna DEBE -->
          <div>
            <div class="tch dl">DEBE</div>
            <div class="tent">
              ${data.d.map(r => `
                <div class="trow">
                  <span class="tref">${r.ref}</span>      <!-- Referencia a la partida -->
                  <span class="tad">${fmt(r.amount)}</span> <!-- Monto en rojo -->
                </div>`).join('') || '<div style="color:var(--text2);font-size:.72rem;">â€”</div>'}
              ${totD > 0 ? `
                <div class="tsum">
                  <span class="tsuml">Î£ Debe</span>
                  <span class="tsvd">${fmt(totD)}</span>
                </div>` : ''}
            </div>
          </div>
          <!-- Divisor vertical -->
          <div class="tdiv"></div>
          <!-- Columna HABER -->
          <div>
            <div class="tch cl">HABER</div>
            <div class="tent">
              ${data.c.map(r => `
                <div class="trow" style="justify-content:space-between;">
                  <span class="tac">${fmt(r.amount)}</span> <!-- Monto en verde -->
                  <span class="tref">${r.ref}</span>
                </div>`).join('') || '<div style="color:var(--text2);font-size:.72rem;">â€”</div>'}
              ${totC > 0 ? `
                <div class="tsum" style="justify-content:flex-end;gap:8px;">
                  <span class="tsuml">Î£ Haber</span>
                  <span class="tsvc">${fmt(totC)}</span>
                </div>` : ''}
            </div>
          </div>
        </div>
        <!-- Pie: saldo final de la cuenta (positivo = deudor, negativo = acreedor) -->
        <div class="tftr">
          <span class="tsll">Saldo ${saldo >= 0 ? 'Deudor' : 'Acreedor'}</span>
          <span class="tslv ${saldo >= 0 ? 'd' : 'c'}">${fmt(Math.abs(saldo))}</span>
        </div>
      </div>`;
    }).join('');

  /* â”€â”€ ACTUALIZAR DOM: CatÃ¡logo de cuentas â”€â”€ */
  document.getElementById('c-out').innerHTML = Object.entries(CUENTAS).map(([code, c]) => `
    <tr>
      <td style="font-family:'IBM Plex Mono',monospace;color:var(--gold);font-size:.8rem;">${code}</td>
      <td style="color:var(--text);">${c.n}</td>
      <td><span class="ttipo ${c.t.toLowerCase().split('(')[0].trim()}" style="font-size:.68rem;">${c.t}</span></td>
      <td style="color:var(--text2);font-size:.8rem;">${c.nat}</td>
    </tr>`).join('');

  /* Muestra la secciÃ³n de resultados y hace scroll hacia los KPIs de IVA */
  document.getElementById('results').style.display = 'block';
  document.getElementById('iva-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FUNCIÃ“N: showTab(id, btn)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROPÃ“SITO: Controla la visibilidad de los paneles de pestaÃ±a.
   
   Algoritmo:
   1. Remueve la clase 'on' de todos los .panel â†’ ocuita todos
   2. Remueve la clase 'on' de todos los .tab â†’ desactiva todos
   3. Agrega 'on' al panel con id indicado â†’ muestra ese panel
   4. Agrega 'on' al botÃ³n presionado â†’ lo marca como activo
   
   @param {string}      id  - ID del panel a mostrar ('t-j','t-m','t-c')
   @param {HTMLElement} btn - BotÃ³n que fue presionado
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showTab(id, btn) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('on'));
  document.querySelectorAll('.tab').forEach(b => b.classList.remove('on'));
  document.getElementById(id).classList.add('on');
  btn.classList.add('on');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INICIALIZACIÃ“N DE LA APLICACIÃ“N
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   1. renderOps() â†’ inserta las 9 tarjetas de operaciones en el DOM
   2. setTimeout(calcular, 80) â†’ espera 80ms antes de calcular.
      Esto es necesario porque renderOps() modifica el DOM y los
      elementos de input no existen hasta que el navegador procesa
      el innerHTML. El setTimeout permite ese ciclo de renderizado.
      
      Sin el setTimeout, gv('f1') retornarÃ­a null porque el input
      con id="f1" todavÃ­a no existe en el DOM cuando se llama calcular().
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
renderOps();
setTimeout(calcular, 80); /* Calcula con los valores por defecto al cargar la pÃ¡gina */
</script>
</body>
</html>
